# HyperSense Recurring Jobs Configuration
#
# DYNAMIC SCHEDULING:
# - TradingCycleJob and ForecastJob are now self-scheduling based on market volatility
# - They are NOT in this file - they are bootstrapped via BootstrapTradingCycleJob
# - Intervals: Very High (3 min), High (6 min), Medium (12 min), Low (25 min)
#
# FIXED SCHEDULING:
# - MacroStrategyJob: Daily at 6am (sets market bias)
# - MarketSnapshotJob: Every minute (data collection)
# - RiskMonitoringJob: Every minute (SL/TP enforcement)
# - BootstrapTradingCycleJob: Every 30 min (safety net to restart trading chain)

default: &default
  # Macro strategy analysis - runs daily to set high-level direction
  macro_strategy:
    class: MacroStrategyJob
    queue: analysis
    schedule: every day at 6am

  # Market data collection - runs more frequently for data pipeline
  market_snapshot:
    class: MarketSnapshotJob
    queue: data
    schedule: every minute

  # Risk monitoring - enforces SL/TP and monitors circuit breaker
  risk_monitoring:
    class: RiskMonitoringJob
    queue: risk
    schedule: every minute

  # Bootstrap job - ensures trading cycle chain is running
  # Safety net that runs every 30 minutes to restart chain if broken
  bootstrap_trading_cycle:
    class: BootstrapTradingCycleJob
    queue: trading
    schedule: every 30 minutes

development:
  <<: *default

production:
  <<: *default
  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12
